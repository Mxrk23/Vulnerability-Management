<h1>Creating a Vulnerability Management Lab| Conducting Credentialed & Non-Credentials Scans with Nessus</h1>

 

<h2>Description</h2>
For this project, I will be making a vulnerability management lab where I will be installing Nessus Essentials, VMware Fusion and install old deprecated software in which I will then do vulnerability credentialed and non credentialed scans against the virtual machine to discover any vulnerabilities that might be on the VM. I will further walk through remediating some of these vulnerabilities and compare the results of each type of scans I will make. 
<br />

Tools and Utilities

- Nessus Essential

- VMware Fusion

- Deprecated software (old version of Firefox)

- Windows 10 ISO


<h2>Lab walk-through:</h2>

<p align="center">
1.Installation: <br/>
<br>My first steps are to install Nessus Essentials, this is the vulnrability scanner that will be used to conduct scans on the VM. VMWare fusion will be also be installed, this is a software program that allows  my macOS to run other operating systems. Lastly, I will install Windows 10 ISO which is a disk image file that contains all installation files of Windows 10.<br>

<img src="https://i.imgur.com/IFkqQqr.jpeg" alt="Vulnerability Management Lab"/>


<p align="center">
1.1 Configuration. <br/>
<br>After installing VMware Fusion, I’ve started setting up my virtual machine. The main configuration I’ve made is to set my Network Adapter to bridge. This puts my virtual machine in the same network as my macbook, this helps my nessus imlpementation to communicate with the virtual machine more easily. <br>

<img src="https://i.imgur.com/HT2gil5.jpeg" alt="Vulnerability Management Lab"/>


<p align="center">
1.2 Installation. <br/>
<br>After installing VMware Fusion, I’ve installed the Windows 10 ISO on the VM and completed the windows startup <br>

<img src="https://i.imgur.com/JBc2m7c.jpeg" alt="Vulnerability Management Lab"/>

<p align="center">
1.3. Ensure Connectivity.  <br/>
<br>ATo ensure that I have conenctivity to the VM I will be conducting a basic scan against the virtual machine. To do this, I’ve ran an ipconfig command on the Vm to find out the ip address and I will ping the IP address from my local machine.<br>

<img src="https://i.imgur.com/dOgQYy1.jpeg" alt="Vulnerability Management Lab"/>


<p align="center">
1.4. Ping.  <br/>
<br>I’ve pinged the VM but the echo requests are timing out. To resolve this, I will have to disable the firewalls on the VM. This isn’t recommend to be done in production but because this is just a lab there isn’t any consequence. <br>

<img src="https://i.imgur.com/iCDVPYJ.jpeg" alt="Vulnerability Management Lab"/>

<p align="center">
1.5. VM Firewalls. <br/>
<br>I’ve opened up wf.msc on my VM and turned off my domain profile, private profile and public profile firewalls off. Now that I should be able to to see echo replies from my local machine.<br>

<img src="https://i.imgur.com/M6H0G9B.jpeg" alt="Vulnerability Management Lab"/>

<p align="center">
1.6. Echo Replies <br/>
<br>Echo replies are now sent to my local machine. I am now ensured that I have connectivity to my VM<br>

<img src="https://i.imgur.com/3CrMvsy.jpeg" alt="Vulnerability Management Lab"/>

<p align="center">
2. Nessus Scan.<br/>
<br>Back on my local machie, I’ve opened up Nessus Essential and created a new basic network scan. I’ve included the IP address of the VM as a target<br>

<img src="https://i.imgur.com/MEaid9k.jpeg" alt="Vulnerability Management Lab"/>

<p align="center">
2.2 Nessus Findings.<br/>
<br>I’ve launched the scan and only a few moments after it produced some logs and findings in the vulnerabilties section. I will wait for the scan to be completed and then I will analyse on what Nessus has identified on my VM<br>

<img src="https://i.imgur.com/WE3Mrf8.jpeg" alt="Vulnerability Management Lab"/>

<p align="center">
3. Analysing Scans<br/>
<br>The Nessus scan is now complete, in the bottom left I can see the severity of the scans. Majority of the vulneraibiltiies are info. Majority of organisations usually take precedence in foucisng their attention on critical or high due to having a vast number of them. For this scenario because I didnt use any credentials for my scans I don’t see that many high or critical vulnerabities inside the VM.<br>

<img src="https://i.imgur.com/ff1o3Gm.jpeg" alt="Vulnerability Management Lab"/>


<p align="center">
3.1. Analysing Scans.<br/>
<br>Here I’ve examined traceroute information which has a severity level of info. This scan is telling me that icmp is accepted on the VM.  Info are usually not considered a vulnerability but something that should be made aware of. <br>

<img src="https://i.imgur.com/b9LxHIT.jpeg" alt="Vulnerability Management Lab"/>

<p align="center">
3.2. Analysing Scans.<br/>
<br>This scan is telling me that Nessus wasn’t able to successfully authenticate directly to the remote target. This is because I didn’t provide any credentials which is also explained in the output box below the description - ‘SMB was detected on port 445’ (means it’s listening on port 445) ‘but no credentials are provided’. <br>

<img src="https://i.imgur.com/LLHHLFO.jpeg" alt="Vulnerability Management Lab"/>


<p align="center">
4.Running Credential Scans. <br/>
<br>My next step will be to setup the virtual machine to be able to accept authenticated scans and I’m going to provide some crendentials to Nessus and I will rescan the virtual machine with credentials. I will then compare the results of the new scan with the scan I’ve done without credentials. My first towards this is to open up services on my VM and enable remote registry which will allow Nessus to connect to the VM’s registry and look for insecure configurations e.g depreicated cipher suites. <br>

<img src="https://i.imgur.com/23PDwl3.jpeg" alt="Vulnerability Management Lab"/>

<p align="center">
4.1 User Account Control. <br/>
<br>My next step is to disable notification when there any changes attempted to be made on the VM. This is not good practice but I need to make my VM susceptible in order to produce the scans I want. <br>

<img src="https://i.imgur.com/2EfHHyx.jpeg" alt="Vulnerability Management Lab"/>


<p align="center">
4.2. Adding Key to Registry.  <br/>
<br>My next step is to add a key to the registry that will further disable my user account controls for the remote account i’m going to use to connect to this VM for the scan. 
Under LocalMachine>Software>Microsoft>Windows>CurrentVersion>Policies>System I’ve made a LocalAccountTokenFilterPolicy and set a value of 1. After this,  I am ready to rescan the VM after I’ve restarted Windows.<br>

<img src="https://i.imgur.com/y5YMvnm.jpeg"/>

<p align="center">
4.3. Adding Credentials.  <br/>
<br>Back on my Nessus tab, I’ve added my credentials used to access my Windows VM. I will now run the scan again and will be expecting more results since I’ve enabled credentials scanning and configured the VM to accept remote scans<br>

<img src="https://i.imgur.com/UFOWhhD.jpg"/>

<p align="center">
4.4. Credential Scan.  <br/>
<br>Once the scan has finished, I can immediately see the increased results from vulnerabilities labled as medium, highsand criticals. This solidified the importance of running crendetial scans oppose to non-credential scans.<br>

<img src="https://i.imgur.com/Rc28l7r.jpeg"/>

<p align="center">
5.1. Remediation.  <br/>
<br>At the remediation tab, it gives a high level of instructions on how to remediate most of the findings that are high level. At the top, I can see that most of the vulnerabiltiies can be resolved by installing window updates. Before remediating some of these vulnerabilities I wi;; be installing a deprecated firefox software on the VM and run another scan as well as compare the results with the previous two scans.<br>

<img src="https://i.imgur.com/DsqgdHt.jpg"/>

<p align="center">
5.2. Installing Firefox.   <br/>
<br>I’ve opened up my VM and searched for deprecated versions of firefox and proceeded to downlaod it into my VM.<br>

<img src="https://i.imgur.com/U7QY3Ut.jpg"/>

<p align="center">
5.3. Running Scan.    <br/>
<br>I will now run another scan on Nessus. There’s no changes I need to make on my current Nessus scan as it will do the same thing as before - scan all the common ports, inspect the registry, inspect the services and inspect the file system. Nessus will discover the deprecated version of firefox that will have a large number of vulnerabiltiies<br>

<img src="https://i.imgur.com/h3CJtdP.jpg"/>


<p align="center">
6. Third scan results.    <br/>
<br>Once my Nessus scan was completed, the first notice is the large jump in vulnerabilities classed as critical, high and medium.<br>

<img src="https://i.imgur.com/rStHoP2.jpg"/>

<p align="center">
6.1. Remediation methods    <br/>
<br>My next step will be to remediate some of the vulnerabilities by doing basic tasks such as uninstalling firefox completely and running windows updates<br>

<img src="https://i.imgur.com/DsqgdHt.jpg"/>

<p align="center">
6.2. Uninstalling deprecated software<br/>
<br>I’ve gone back to my VM and uninstalled Firefox.<br>

<img src="https://i.imgur.com/AsoXIoN.jpg"/>


<p align="center">
6.3 Windows Updates. <br/>
<br>I’ve opened up Windows startup to manually run windows updates. This remediates most of the vulnerabilities alerted by nessus<br>

<img src="https://i.imgur.com/bayq3OU.jpg"/>

<p align="center">
7. Final Scan. <br/>
<br>In my final scan, I can see most of the critical, high and medium level vulnerabilities have been resolved simply through making system updates and removing deprecated software.<br>

<img src="https://i.imgur.com/GMVVoJm.jpg"/>

